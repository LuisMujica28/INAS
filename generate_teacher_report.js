
const SCHEDULE_DB = {
    "transicion": {
        name: "Transición",
        director: "Merly Tapias",
        endTime: "23:50",
        blocks: [
            ["Lenguaje", "Ed. Física", "Inglés", "Biología", "Lenguaje"],
            ["Matemáticas", "Tecnología", "Matemáticas", "Artes", "Biología"],
            ["Inglés", "Inglés", "Lenguaje", "Lenguaje", "Inglés"],
            ["Sociales", "Matemáticas", "Ética–Religión", "Matemáticas", "Sociales"]
        ]
    },
    "101": {
        name: "101",
        director: "Sonia Agudelo",
        endTime: "23:50",
        blocks: [
            ["Matemáticas", "Inglés", "Matemáticas", "Lenguaje", "Sociales"],
            ["Inglés", "Biología", "Inglés", "Geometría", "Inglés"],
            ["Ed. Física", "Ética-Religión", "Sociales", "Artes", "Biología"],
            ["Lenguaje", "Lenguaje", "Lenguaje", "Tecnología", "Matemáticas"]
        ]
    },
    "201": {
        name: "201",
        director: "Katherine Suarez",
        endTime: "23:50",
        blocks: [
            ["Sociales", "Geometría", "Lenguaje", "Matemáticas", "Inglés"],
            ["Lenguaje", "Inglés", "Ética-Religión", "Lenguaje", "Lenguaje"],
            ["Biología", "Artes", "Inglés", "Ed. Física", "Tecnología"],
            ["Matemáticas", "Sociales", "Matemáticas", "Sociales", "Biología"]
        ]
    },
    "301": {
        name: "301",
        director: "Flor Angela Calvo",
        endTime: "23:50",
        blocks: [
            ["Inglés", "Lenguaje", "Biología", "Ed. Física", "Geometría"],
            ["Artes", "Ética-Religión", "Lenguaje", "Tecnología", "Matemáticas"],
            ["Matemáticas", "Sociales", "Matemáticas", "Sociales", "Lenguaje"],
            ["Biología", "Química", "Inglés", "Inglés", "Sociales"]
        ]
    },
    "401": {
        name: "401",
        director: "Luis Carlos Carvajal",
        endTime: "23:50",
        blocks: [
            ["Biología", "Química", "Ed. Física", "Tecnología", "Sociales"],
            ["Matemáticas", "Lenguaje", "Biología", "Sociales", "Matemáticas"],
            ["Sociales", "Matemáticas", "Geometría", "Inglés", "Ética-Religión"],
            ["Inglés", "Inglés", "Artes", "Lenguaje", "Lenguaje"]
        ]
    },
    "501": {
        name: "501",
        director: "Yuli Gonzalez",
        endTime: "23:50",
        blocks: [
            ["Inglés", "Biología", "Química", "Ética-Religión", "Biología"],
            ["Lenguaje", "Ed. Física", "Lenguaje", "Inglés", "Lenguaje"],
            ["Tecnología", "Matemáticas", "Inglés", "Matemáticas", "Matemáticas"],
            ["Artes", "Geometría", "Sociales", "Sociales", "Sociales"]
        ]
    },
    "601": {
        name: "601",
        director: "Alexandra Díaz",
        endTime: "23:50",
        blocks: [
            ["Matemáticas", "Matemáticas", "Lenguaje", "Lenguaje", "Biología"],
            ["Sociales", "Sociales", "Geometría", "Química", "Sociales"],
            ["Artes", "Biología", "Ed. Física", "Ética-Religión", "Inglés"],
            ["Lenguaje", "Inglés", "Inglés", "Matemáticas", "Tecnología"]
        ]
    },
    "602": {
        name: "602",
        director: "Carlos Gómez",
        endTime: "23:50",
        blocks: [
            ["Lenguaje", "Sociales", "Tecnología", "Inglés", "Lenguaje"],
            ["Biología", "Geometría", "Sociales", "Ética-Religión", "Inglés"],
            ["Inglés", "Ed. Física", "Química", "Matemáticas", "Sociales"],
            ["Matemáticas", "Artes", "Lenguaje", "Biología", "Matemáticas"]
        ]
    },
    "701": {
        name: "701",
        director: "José Jiménez",
        endTime: "23:50",
        blocks: [
            ["Lenguaje", "Sociales", "Matemáticas", "Matemáticas", "Tecnología"],
            ["Matemáticas", "Inglés", "Sociales", "Ed. Física", "Biología"],
            ["Sociales", "Lenguaje", "Geometría", "Inglés", "Artes"],
            ["Biología", "Ética-Religión", "Lenguaje", "Química", "Inglés"]
        ]
    },
    "801": {
        name: "801",
        director: "Ibón Angélica Pulido",
        endTime: "23:50",
        blocks: [
            ["Ed. Física", "Lenguaje", "Inglés", "Física", "Inglés"],
            ["Biología", "Matemáticas", "Artes", "Sociales", "Lenguaje"],
            ["Lenguaje", "Geometría", "Química", "Tecnología", "Matemáticas"],
            ["Inglés", "Sociales", "Sociales", "Ética-Religión", "Biología"]
        ]
    },
    "802": {
        name: "802",
        director: "Laura Carolina Bernal",
        endTime: "23:50",
        blocks: [
            ["Biología", "Inglés", "Ética-Religión", "Biología", "Ed. Física"],
            ["Sociales", "Lenguaje", "Inglés", "Lenguaje", "Artes"],
            ["Matemáticas", "Química", "Geometría", "Sociales", "Sociales"],
            ["Lenguaje", "Física", "Tecnología", "Inglés", "Matemáticas"]
        ]
    },
    "901": {
        name: "901",
        director: "Esteban Morales",
        endTime: "23:50",
        blocks: [
            ["Sociales", "Ética-Religión", "Inglés", "Inglés", "Sociales"],
            ["Ed. Física", "Lenguaje", "Tecnología", "Geometría", "Matemáticas"],
            ["Lenguaje", "Sociales", "Lenguaje", "Inglés", "Química"],
            ["Física", "Biología", "Matemáticas", "Artes", "Inglés"]
        ]
    },
    "1001": {
        name: "1001",
        director: "Maritza Triana",
        endTime: "23:50",
        blocks: [
            ["Matemáticas", "Lenguaje", "Sociales", "Filosofía", "Matemáticas"],
            ["Inglés", "Artes", "Matemáticas", "Lenguaje", "Ed. Física"],
            ["Ética-Religión", "Física", "Inglés", "Química", "Inglés"],
            ["Sociales", "Tecnología", "Química", "Física", "Lenguaje"]
        ]
    },
    "1101": {
        name: "1101",
        director: "Luis Mujica",
        endTime: "23:50",
        blocks: [
            ["Ética-Religión", "Física", "Filosofía", "Sociales", "Inglés"],
            ["Matemáticas", "Química", "Ed. Física", "Física", "Matemáticas"],
            ["Química", "Lenguaje", "Sociales", "Lenguaje", "Lenguaje"],
            ["Tecnología", "Inglés", "Matemáticas", "Inglés", "Artes"]
        ]
    }
};

const TEACHER_ASSIGNMENTS = {
    "sociales": {
        "transicion": "Merly Tapias", "101": "Merly Tapias",
        "201": "Carlos Gómez", "301": "Carlos Gómez", "401": "Carlos Gómez", "501": {
            "default": "Esteban Morales",
            "exceptions": [
                { day: 2, block: 3, teacher: "Carlos Gómez" } // Wednesday (2), 12:30-2:15 is typically 4th block (index 3) or check schedule? 
                // Wait, checking block structure:
                // blocks: [ [M, T, W, Th, F] (Block 1), [M, T, W, Th, F] (Block 2) ... ] ??
                // NO. The data structure is:
                // blocks: [ 
                //    ["Matemáticas", "Inglés", ...], // This looks like Block 1 for Mon, Tue, Wed, Thu, Fri ??
                //    ...
                // ]
                // Let's verify structure from file content.
                // Line 8: ["Lenguaje", "Ed. Física", "Inglés", "Biología", "Lenguaje"],
                // This implies Row 0 is Block 1, and the array is [Mon, Tue, Wed, Thu, Fri].
                // So Wednesday is index 2.
                // "Miercoles de 12:30 a 2:15".
                // Usually schedules are:
                // Block 1: 6:30 - 8:15
                // Block 2: 8:45 - 10:30
                // Block 3: 10:30 - 12:15 ?? Or 10:30-12:30?
                // The user said "Miercoles de 12:30 a 2:15". 
                // Assuming standard 4 block schedule:
                // Block 1, Block 2, Block 3, Block 4.
                // If 12:30 is the last block, it is Block 4 (index 3).
            ]
        },
        "601": "Carlos Gómez",
        "701": "Esteban Morales", "801": "Esteban Morales", "802": "Esteban Morales", "901": "Esteban Morales", "1001": "Esteban Morales", "1101": "Esteban Morales"
    },
    "ética-religión": {
        "default": "Merly Tapias"
    },
    "ética–religión": { // handling variations
        "default": "Merly Tapias"
    },
    "inglés": {
        "transicion": "Sonia Agudelo", "101": "Sonia Agudelo", "201": "Sonia Agudelo", "301": "Sonia Agudelo", "401": "Sonia Agudelo",
        "501": "Laura Carolina Bernal", "601": "Laura Carolina Bernal", "602": "Laura Carolina Bernal", "701": "Laura Carolina Bernal", "801": "Laura Carolina Bernal", "802": "Laura Carolina Bernal",
        "901": {
            "default": "Maritza Triana",
            "exceptions": [
                { day: 3, block: 0, teacher: "Sonia Agudelo" } // Thursday (3), 1st block (0)
            ]
        },
        "1001": "Maritza Triana", "1101": "Maritza Triana"
    },
    "lenguaje": {
        "transicion": "Katherine Suarez", "101": "Katherine Suarez", "201": "Katherine Suarez", "301": "Katherine Suarez", "401": "Katherine Suarez",
        "501": "Alexandra Díaz", "601": "Alexandra Díaz", "602": "Alexandra Díaz", "901": "Alexandra Díaz", "1001": "Alexandra Díaz", "1101": "Alexandra Díaz",
        "701": "Maritza Triana", "801": "Maritza Triana", "802": "Maritza Triana"
    },
    "biología": {
        "transicion": "Flor Angela Calvo", "101": "Flor Angela Calvo", "201": "Flor Angela Calvo", "301": "Flor Angela Calvo", "401": "Flor Angela Calvo", "601": "Flor Angela Calvo",
        "501": "Ibón Angélica Pulido", "701": "Ibón Angélica Pulido", "801": "Ibón Angélica Pulido", "901": "Ibón Angélica Pulido", "602": "Flor Angela Calvo", "201": "Flor Angela Calvo" // Add missing if needed
    },
    "química": {
        "301": "Flor Angela Calvo", "401": "Flor Angela Calvo", "601": "Flor Angela Calvo",
        "1001": "Ibón Angélica Pulido", "1101": "Ibón Angélica Pulido", "501": "Ibón Angélica Pulido", "801": "Ibón Angélica Pulido", "602": "Flor Angela Calvo"
    },
    "tecnología": {
        "default": "Luis Carlos Carvajal"
    },
    "matemáticas": {
        "401": "Luis Carlos Carvajal",
        "transicion": "Yuli Gonzalez", "101": "Yuli Gonzalez", "201": "Yuli Gonzalez", "301": "Yuli Gonzalez", "501": "Yuli Gonzalez",
        "601": "José Jiménez", "602": "José Jiménez", "701": "José Jiménez", "901": "José Jiménez",
        "801": "Luis Mujica", "802": "Luis Mujica", "1001": "Luis Mujica", "1101": "Luis Mujica"
    },
    "geometría": {
        "401": "Luis Carlos Carvajal",
        "101": "Yuli Gonzalez", "201": "Yuli Gonzalez",
        "301": "José Jiménez", "501": "José Jiménez", "601": "José Jiménez", "602": "José Jiménez", "801": "José Jiménez", "802": "José Jiménez", "901": "José Jiménez",
        "701": "Luis Mujica"
    },
    "filosofía": {
        "1001": "Carlos Gómez", "1101": "Carlos Gómez"
    },
    "física": {
        "801": "Luis Mujica", "802": "Luis Mujica", "901": "Luis Mujica", "1001": "Luis Mujica", "1101": "Luis Mujica"
    },
    "ed. física": {
        "default": "Freddy Pacheco"
    },
    "artes": {
        "default": "Carolina Acosta"
    }
};

function getTeacher(subject, grade, dayIndex, blockIndex) {
    if (!subject || subject === "DESCANSO" || subject === "---") return "";

    const subjKey = subject.toLowerCase().trim();
    const assignment = TEACHER_ASSIGNMENTS[subjKey]; // Look for exact match

    if (assignment) {
        // Check for specific grade config
        let gradeConfig = assignment[grade];

        // Handle string vs object config
        if (typeof gradeConfig === 'string') {
            return gradeConfig;
        } else if (typeof gradeConfig === 'object' && gradeConfig !== null) {
            // Check exceptions
            if (gradeConfig.exceptions) {
                const exception = gradeConfig.exceptions.find(ex => ex.day === dayIndex && ex.block === blockIndex);
                if (exception) return exception.teacher;
            }
            return gradeConfig.default || "Desconocido";
        }

        return assignment["default"] || "Desconocido";
    }

    // Fallback for variations?
    return "Desconocido (" + subject + ")";
}

// Generate Report
const report = {};

Object.keys(SCHEDULE_DB).forEach(gradeKey => {
    const grade = SCHEDULE_DB[gradeKey];
    grade.blocks.forEach((block, blockIndex) => {
        block.forEach((subject, dayIndex) => {
            const teacher = getTeacher(subject, gradeKey, dayIndex, blockIndex);
            if (teacher && teacher !== "Desconocido") {
                if (!report[teacher]) {
                    report[teacher] = new Set();
                }
                report[teacher].add(`${subject} (${grade.name})`);
            }
        });
    });
});

import fs from 'fs';

// Generate Report String
let output = "# Reporte de Carga Académica\n\n";
Object.keys(report).sort().forEach(teacher => {
    output += `## ${teacher}\n`;
    const subjects = Array.from(report[teacher]).sort();
    subjects.forEach(subj => output += `- ${subj}\n`);
    output += "\n";
});

fs.writeFileSync('reporte_profesores.md', output, 'utf8');
console.log("Reporte generado en reporte_profesores.md");
